<html>
	<head>
		<title>BubbleBase -- a Firebase demo game</title>
		<script src="https://code.createjs.com/easeljs-0.8.2.min.js"></script>
		<script src="https://code.createjs.com/tweenjs-0.6.2.min.js"></script>
		<style>
		html, body {
			overflow: hidden;
		}
		</style>
		<script>
		function init() {
			stage = new createjs.Stage("gameCanvas");
			stage.canvas.width = window.innerWidth;
			stage.canvas.height = window.innerHeight;

			character = createCircle(100, 100, 20);
			stage.addChild(character);
			
			food = createCircle(900, 100, 10);
			stage.addChild(food);
			
			createjs.Ticker.setFPS(60);
			createjs.Ticker.addEventListener("tick", tick);
		}

		function tick() {
			// update circle
			character.y += character.vy;
			character.x += character.vx;

			var a = character.x - food.x;
			var b = character.y - food.y;
			var c = Math.sqrt(a*a + b*b);
			if (c <= character.radius + food.radius) {
				updateCircleRadius(character, character.radius+10);
				deleteCircle(food);
			}

			stage.update();
		}

		function createCircle(x, y, radius) {
			var newCircle = new createjs.Shape();
			newCircle.graphics.beginFill("DeepSkyBlue").drawCircle(0, 0, radius);
			newCircle.x = x;
			newCircle.y = y;
			newCircle.vx = 0;
			newCircle.vy = 0;
			newCircle.radius = radius;
			return newCircle;
		}

		function updateCircleRadius(circle, radius) {
			circle.graphics.clear();
			circle.graphics.beginFill("DeepSkyBlue").drawCircle(0, 0, radius);
			circle.radius = radius;
		}

		function deleteCircle(circle) {
			circle.graphics.clear();
			circle.x = -1000;
			circle.y = -1000;
			circle.radius = 0;
		}

		document.onkeydown = function (e) {
			e = e || window.event;

			if (e.keyCode == "38") { 	character.vy = -10;	} // up
			else if (e.keyCode == "40") {	character.vy = 10;		} //down
			else if (e.keyCode == "37") {	character.vx = -10;	} // left
			else if (e.keyCode == "39") {	character.vx = 10;		} // right
		}
		document.onkeyup = function (e) {
			e = e || window.event;

			if (e.keyCode == "38") {	character.vy = 0;	} // up
			else if (e.keyCode == "40") {	character.vy = 0;	} // down
			else if (e.keyCode == "37") {	character.vx = 0;	} // left
			else if (e.keyCode == "39") {	character.vx = 0;	} // right
		}
		</script>
	</head>

	<body onload="init();">
		<canvas id="gameCanvas" width="500" height="300"></canvas>
	</body>
</html>